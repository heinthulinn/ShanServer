const { aiPlayersList } = require("../state/users");

function assignBaseAiFirst(table) {
  const MIN_AI = 2;
  const MAX_AI = 3;

  // already assigned â†’ do nothing
  if (table.players.some(p => p.isAi)) return;

  const aiCount = Math.min(
    MAX_AI,
    Math.max(MIN_AI, table.maxPlayers - 1)
  );

  for (let i = 0; i < aiCount; i++) {
    const ai = aiPlayersList[i];

    table.players.push({
      username: ai.name,
      balance: ai.unit,
      seatId: i + 1, // AI ALWAYS TAKE SEAT 1,2,3
      isAi: true,
      ready: true,
      waiting: false
    });
  }

  console.log(`ðŸ¤– AI assigned FIRST (${aiCount})`);
}

function getAvailableSeat(table) {
  const used = new Set(table.players.map(p => p.seatId));
  for (let i = 1; i <= table.maxPlayers; i++) {
    if (!used.has(i)) return i;
  }
  return null;
}

module.exports = { assignBaseAiFirst, getAvailableSeat };
